sudo: required
services:
- docker
language: go
script:
- set -e
- export BUILD_NUMBER=$TRAVIS_BUILD_NUMBER
- BASE=$(echo $PWD | sed "s|$GOPATH/src/||")
- GO_TEST_PACKAGES=$(go list ./... | grep -v vendor | sed "s|$(BASE)/|./|" )
- go test $GO_TEST_PACKAGES
# - goveralls -coverprofile=coverage.out -service travis-ci -repotoken $COVERALLS_TOKEN
# 
before_install:
- docker login -u $DOCKER_REG_USERNAME -p $DOCKER_REG_PASSWORD $DOCKER_REGISTRY
- chmod 755 ./docker-push.sh
- go get github.com/mitchellh/gox
- go get github.com/tcnksm/ghr
- go get github.com/axw/gocov/gocov
- go get github.com/mattn/goveralls
- go get code.google.com/p/go.tools/cmd/cover
after_success:
- make builddocker
- "./docker-push.sh"
- gox -output "dist/{{.OS}}_{{.Arch}}_{{.Dir}}"
- ghr --username $GITHUB_USER --token $GITHUB_TOKEN --replace --prerelease --debug
  pre-release dist/
env:
  global:
  - secure: KJXCRRcmQH+2WKozskAxXiHmwWpnVsnAnEhdwzoy420K2i17kRjV+Xo6DvNOUyMOG7H0fzxVHM25/WUZSO8BsnRKlWOsYrCwV+A9hX/G3T0qWpTdmM4gwU9jGdjxC4WoD/6gGRgDrhuw9Ao3MpzNBCG5zBB5rDjAl9sGkAAf+P+OH9oJB8WuJVcqjHeCY+xsnYC6sEp4ukcWuXNJL9WBS3RKZqTXjnX3w8DwU04jPVW6L/rHFIdzce7mhNba9WUgnPwUVpwmmCbydPt3zv0RjMj8sngUgBFXHR0RFqbU2+5GJhkxRi0e+rqS0olcJWiHOrgSP6CQOUmgn2Kg3aTQHgrqUETyvZ2OE8fgBj98BbZnY+EBQpVgX3nozIzIQRJOyI0TReNJAZ6nrUUD0tVLgtqiOSdhVdR9mfR5c6pWoGM9zQHWd5TixfuDLrluZH6zLiaZJ4LiNAbjAORzEWmB+IvNW3dLRWntP7JLd3lGeA0WrW0OHfnPrfizqtJHV7Ls2lhRyu+a4R1sLtguvh8bxksSpzmS8+mELKXfjioD90g7zxMZ7oM4qr99KqpsEaovEQka9CvGmJZRF42JtOuBD03io5drcShcVIGV1hZo/Zz7vOjqX7VFCCL/kCkG6hpcqCPCz6KS/7q+fkjwiZInqNWl/nZGr0qjSdscfHcevTo=
  - secure: b8q4ZsHv0deST7xWD6zn60fG3jTVwTyofEGq5Ttj5y0EBX89IdpXgrUzKHzzCg55LEqbglbZQizgREeUlTrXU9/TXecRxsXz9U27f4GUqczHzPXxu0zTrgIhJgtam3ZzwaNES0EIYSEzyodMre9mIDR9iEu6vG3LWNqD7hSBio0BWQwwTSfkQrRMwCrL2AAQ64B/cz7Svp5QK3lHNnXOY/EA/0n9uksT5x5L1wW+GR9wqw5JATLuniDfssL0K+yXDHZ4tcKKy0nShQ8jmucM2pADbjBYQmx4cU1PorbRBE0onO7hF/5Wob/rW8SQaRPHnMsw+rc5oGZg+LKgwkKbc7ZsGuVxBVB4hZGjAaXW/8y+vv4dnIW5hBhi5kAHUIt9O3TI1djtJxgD1jcTAZltlB1QaQobkzjjH7Xq+yEpgWoXkYbKWpXAMdmArQvT+/TMIZdBqNcgyQA1YBwOLrSIQ6ayajkDGicf/Q08KLqfTEtjwMV5uiklZ72UPLpgwFnZg6qu0EhFJw3vHicW+Ic/XdLZP/XWGUUD5/JI/u4GdOxZEJYcsnqHsbeMov4CCMsmtlSjLv9mLEgg25/tuFHPoxW5uRD/3BLL262EaI803nX3ftzJmy+Qk+MxSZyiKN7MdtatV6ozO6fS9ksYZA2cbfL3yMdgg42gfb5552FDlQs=
  - secure: eKWwSaTqugI0ZoEfKGtw50bsYcwKj0gNfmX6FmGVGw/ds4IOavPa6Ioe42EBw8Xh3bdvRlXOJQGaxAOz4QkAVhPsyhvpU7nZR3q/L2ai/N7BfBCC2LpjgqPlvpv/MMa+jrlPOkAdENTfTDSHG9LKNMWMyVsffJPnhYBKEv5EB13nBngV8yQDy5LsCOPKXtmhVn8pF2rBuZlqiPYDPDlhNKauLDZ2u7fKOJnsMRP+glFCKheXiIDyxhaiov+AXt9RHgUJMYuGU8eJp5qmNYz8k8o7M1mx5fHTRIsSwpJqWL5xHWaQ0hYMsfXR99abGtjVMTjg+qQV5ZbFPXurvVFIEitIhxATFRCkoqU86g2MkYgBigZLrT7ZNbNJgt9gLe20+NjgJkSpsU/VdhLX3j/I5rT88PyOyMuPMQM/JAHKcj0WHvTDuBGjmvH59JLnyP68kJ97w+b22YwJ6OIrm5gKG9CzmJpmrVaySM5fyV7hBSvWs4rfEmKxU1e8uexy1PKx94nTXh1q6/9EVOEO+lSW/TZ/cveWlh1cDkiaMFlguYGVGvnj8vY5FbtYxBA+ahhCXsA1mrw9UYTjQm9hdcxW9mAq6lsskaJ0rip48pxdZZcxZE5T/IP9iC/uwWfWIdKqxYAUbcYCCJT10S951NDV/NsditL0udq9N0UuUCyiRTc=
  - secure: AscJNJr790Z/IThZ4RRRXsvlbyE/UBs0dF0kAntGzULk4EUyfjEpSSIkLEGW95O1HkJqQYxKe3Ulr+IMuZRYd2vpC+bhVDFppk8vltfNSyX0ic3j0aj16KVEBLadiecMFMcBNse17LNNcxAcC4lbTaG4Q2UvNPayMbsGdYAg1GgY9PAHK7kyA7MhBqtTX3gugEDLqYr73KoFMxt1/rcsMvhVvn/Z0In3g/TTFE2QCepTKHbqbIJdD/rAB6+7eetVbvWDrwqItdwnPL5EX/CRbXDDhElgknjv1jruRm3N0U5lLNVN6kWSLIZIXBUY9ybAJ40MF9gEQuD8bMdSndJ8Yl1b7EMLRGvNLxO9Af9wqyFAcbUZdLB03VKmLoyFDxd31P3LXzkOrUf7O6l345QWkcQQXkb26SmS1sIr63xqC6d7pciBZUH+iYS3p1mOwlR3w3AZMj7XXf6Fx+yXgKBtEtxl6u/eblT6Kx60zjhmfdhcIzipZMxdZyMBU9nKbQOcG21De0BsVyLd8WXKmMXQNdEl4wGjJ49Gmg8z6hUPaoFU3xFVh72NWud/nvulsIzzzHjB7giT9Gz228kDs4YLmsDIzMnmwtyLgYuhiSned2820y+MJ5RgOr14ioSVviI3BpgS7+J0qRcXaLb4aq8ZOhMB+KdmIkgyr1ACga+fZJU=
  - secure: hew10t65iGP9FG1nIZBxVN32P5uxxl3r56jcZ9KzzELtLWzaUja8hKbd57E/O7fiuzT2m0POtgmaUdHKo3BlSiGa7EubbCX5W5iJnlddab+5ljLNqJ5x0XJGqunhgnxDmjoPDQwDyaILXWaXsa5ONbyPO1roM7DYzvHoccWKfDjpwkBu7QtMfPtmLoRdw3fRst7wS092/b6aCr0av+jYeLdYRiHxqsOGuJ2Bct2zcANzoZ5MVJfy7Ue83KbMOH6dDA0MNTf4ChkCt3pW4Hu4BiaWLsibD6yR/7p1SfBqqe8aZGD6LJZhPBmx1KanoaSNGB7z/AOsyo5NZU9iH6FcxrMk2nhur5z59JwK1aXPeaedbnmXShN9lKa+g1rNQ2ILdcCYbmTnFuyzp0T7eyPPw0+Dvf0A5m3Xr+j7VCRWL8wAvPNLq/2mwHpXdzCVT7Nvsp/ujKcgcxF+apOLUS0SZmQA1O76WYA1TBsTiNcq/mfYzB/DYnQdYqDe3B/1r4Nf6hF6VF5K6MMCHsclAHxiyZWOCRRMy1NS8Xo/m+H0Xs4NNR4088Vl3AArnFrFmHsOoJvUCbgpZAm6PPztD141ll6UXZVQus2NDVnBLZb5XSicAZHzCethuMEI0VMlPVzkFhj40cRBxL/1AfdmbuJxCZTK8/z/qAsARIbikYN0+Oo=
